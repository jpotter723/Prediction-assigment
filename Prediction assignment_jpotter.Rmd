
R version 4.3.3 (2024-02-29 ucrt) -- "Angel Food Cake"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

>  packs <- c("AppliedPredictiveModeling", "dplyr", "ggplot2", "caret", "rattle", "pgmm", "readr", "randomForest", "parallel", "doMC",
+            "lars", "elasticnet", "lubridate", "forecast", "e1071")
>  success <- suppressWarnings(sapply(packs, require, character.only = TRUE))
Loading required package: AppliedPredictiveModeling
Loading required package: dplyr

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

Loading required package: ggplot2
Loading required package: caret
Loading required package: lattice
Loading required package: rattle
Loading required package: tibble
Loading required package: bitops
Rattle: A free graphical interface for data science with R.
Version 5.5.1 Copyright (c) 2006-2021 Togaware Pty Ltd.
Type 'rattle()' to shake, rattle, and roll your data.
Loading required package: pgmm
Loading required package: readr
Loading required package: randomForest
randomForest 4.7-1.1
Type rfNews() to see new features/changes/bug fixes.

Attaching package: ‘randomForest’

The following object is masked from ‘package:rattle’:

    importance

The following object is masked from ‘package:ggplot2’:

    margin

The following object is masked from ‘package:dplyr’:

    combine

Loading required package: parallel
Loading required package: doMC
Loading required package: lars
Loaded lars 1.3

Loading required package: elasticnet
Loading required package: lubridate

Attaching package: ‘lubridate’

The following objects are masked from ‘package:base’:

    date, intersect, setdiff, union

Loading required package: forecast
Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo 
Loading required package: e1071
> training_set<- read.csv("pml-training.csv")
> testing_set<- read.csv("pml-testing.csv")
> nearZeroVar <- nearZeroVar(training_set)
> train_data <- training_set[,-nearZeroVar]
> test_data <- testing_set[,-nearZeroVar]
> str(test_data)
'data.frame':   20 obs. of  100 variables:
 $ X                       : int  1 2 3 4 5 6 7 8 9 10 ...
 $ user_name               : chr  "pedro" "jeremy" "jeremy" "adelmo" ...
 $ raw_timestamp_part_1    : int  1323095002 1322673067 1322673075 1322832789 1322489635 1322673149 1322673128 1322673076 1323084240 1322837822 ...
 $ raw_timestamp_part_2    : int  868349 778725 342967 560311 814776 510661 766645 54671 916313 384285 ...
 $ cvtd_timestamp          : chr  "05/12/2011 14:23" "30/11/2011 17:11" "30/11/2011 17:11" "02/12/2011 13:33" ...
 $ num_window              : int  74 431 439 194 235 504 485 440 323 664 ...
 $ roll_belt               : num  123 1.02 0.87 125 1.35 -5.92 1.2 0.43 0.93 114 ...
 $ pitch_belt              : num  27 4.87 1.82 -41.6 3.33 1.59 4.44 4.15 6.72 22.4 ...
 $ yaw_belt                : num  -4.75 -88.9 -88.5 162 -88.6 -87.7 -87.3 -88.5 -93.7 -13.1 ...
 $ total_accel_belt        : int  20 4 5 17 3 4 4 4 4 18 ...
 $ max_roll_belt           : logi  NA NA NA NA NA NA ...
 $ max_picth_belt          : logi  NA NA NA NA NA NA ...
 $ min_roll_belt           : logi  NA NA NA NA NA NA ...
 $ min_pitch_belt          : logi  NA NA NA NA NA NA ...
 $ amplitude_roll_belt     : logi  NA NA NA NA NA NA ...
 $ amplitude_pitch_belt    : logi  NA NA NA NA NA NA ...
 $ var_total_accel_belt    : logi  NA NA NA NA NA NA ...
 $ avg_roll_belt           : logi  NA NA NA NA NA NA ...
 $ stddev_roll_belt        : logi  NA NA NA NA NA NA ...
 $ var_roll_belt           : logi  NA NA NA NA NA NA ...
 $ avg_pitch_belt          : logi  NA NA NA NA NA NA ...
 $ stddev_pitch_belt       : logi  NA NA NA NA NA NA ...
 $ var_pitch_belt          : logi  NA NA NA NA NA NA ...
 $ avg_yaw_belt            : logi  NA NA NA NA NA NA ...
 $ stddev_yaw_belt         : logi  NA NA NA NA NA NA ...
 $ var_yaw_belt            : logi  NA NA NA NA NA NA ...
 $ gyros_belt_x            : num  -0.5 -0.06 0.05 0.11 0.03 0.1 -0.06 -0.18 0.1 0.14 ...
 $ gyros_belt_y            : num  -0.02 -0.02 0.02 0.11 0.02 0.05 0 -0.02 0 0.11 ...
 $ gyros_belt_z            : num  -0.46 -0.07 0.03 -0.16 0 -0.13 0 -0.03 -0.02 -0.16 ...
 $ accel_belt_x            : int  -38 -13 1 46 -8 -11 -14 -10 -15 -25 ...
 $ accel_belt_y            : int  69 11 -1 45 4 -16 2 -2 1 63 ...
 $ accel_belt_z            : int  -179 39 49 -156 27 38 35 42 32 -158 ...
 $ magnet_belt_x           : int  -13 43 29 169 33 31 50 39 -6 10 ...
 $ magnet_belt_y           : int  581 636 631 608 566 638 622 635 600 601 ...
 $ magnet_belt_z           : int  -382 -309 -312 -304 -418 -291 -315 -305 -302 -330 ...
 $ roll_arm                : num  40.7 0 0 -109 76.1 0 0 0 -137 -82.4 ...
 $ pitch_arm               : num  -27.8 0 0 55 2.76 0 0 0 11.2 -63.8 ...
 $ yaw_arm                 : num  178 0 0 -142 102 0 0 0 -167 -75.3 ...
 $ total_accel_arm         : int  10 38 44 25 29 14 15 22 34 32 ...
 $ var_accel_arm           : logi  NA NA NA NA NA NA ...
 $ gyros_arm_x             : num  -1.65 -1.17 2.1 0.22 -1.96 0.02 2.36 -3.71 0.03 0.26 ...
 $ gyros_arm_y             : num  0.48 0.85 -1.36 -0.51 0.79 0.05 -1.01 1.85 -0.02 -0.5 ...
 $ gyros_arm_z             : num  -0.18 -0.43 1.13 0.92 -0.54 -0.07 0.89 -0.69 -0.02 0.79 ...
 $ accel_arm_x             : int  16 -290 -341 -238 -197 -26 99 -98 -287 -301 ...
 $ accel_arm_y             : int  38 215 245 -57 200 130 79 175 111 -42 ...
 $ accel_arm_z             : int  93 -90 -87 6 -30 -19 -67 -78 -122 -80 ...
 $ magnet_arm_x            : int  -326 -325 -264 -173 -170 396 702 535 -367 -420 ...
 $ magnet_arm_y            : int  385 447 474 257 275 176 15 215 335 294 ...
 $ magnet_arm_z            : int  481 434 413 633 617 516 217 385 520 493 ...
 $ max_picth_arm           : logi  NA NA NA NA NA NA ...
 $ max_yaw_arm             : logi  NA NA NA NA NA NA ...
 $ min_yaw_arm             : logi  NA NA NA NA NA NA ...
 $ amplitude_yaw_arm       : logi  NA NA NA NA NA NA ...
 $ roll_dumbbell           : num  -17.7 54.5 57.1 43.1 -101.4 ...
 $ pitch_dumbbell          : num  25 -53.7 -51.4 -30 -53.4 ...
 $ yaw_dumbbell            : num  126.2 -75.5 -75.2 -103.3 -14.2 ...
 $ max_roll_dumbbell       : logi  NA NA NA NA NA NA ...
 $ max_picth_dumbbell      : logi  NA NA NA NA NA NA ...
 $ min_roll_dumbbell       : logi  NA NA NA NA NA NA ...
 $ min_pitch_dumbbell      : logi  NA NA NA NA NA NA ...
 $ amplitude_roll_dumbbell : logi  NA NA NA NA NA NA ...
 $ amplitude_pitch_dumbbell: logi  NA NA NA NA NA NA ...
 $ total_accel_dumbbell    : int  9 31 29 18 4 29 29 29 3 2 ...
 $ var_accel_dumbbell      : logi  NA NA NA NA NA NA ...
 $ avg_roll_dumbbell       : logi  NA NA NA NA NA NA ...
 $ stddev_roll_dumbbell    : logi  NA NA NA NA NA NA ...
 $ var_roll_dumbbell       : logi  NA NA NA NA NA NA ...
 $ avg_pitch_dumbbell      : logi  NA NA NA NA NA NA ...
 $ stddev_pitch_dumbbell   : logi  NA NA NA NA NA NA ...
 $ var_pitch_dumbbell      : logi  NA NA NA NA NA NA ...
 $ avg_yaw_dumbbell        : logi  NA NA NA NA NA NA ...
 $ stddev_yaw_dumbbell     : logi  NA NA NA NA NA NA ...
 $ var_yaw_dumbbell        : logi  NA NA NA NA NA NA ...
 $ gyros_dumbbell_x        : num  0.64 0.34 0.39 0.1 0.29 -0.59 0.34 0.37 0.03 0.42 ...
 $ gyros_dumbbell_y        : num  0.06 0.05 0.14 -0.02 -0.47 0.8 0.16 0.14 -0.21 0.51 ...
 $ gyros_dumbbell_z        : num  -0.61 -0.71 -0.34 0.05 -0.46 1.1 -0.23 -0.39 -0.21 -0.03 ...
 $ accel_dumbbell_x        : int  21 -153 -141 -51 -18 -138 -145 -140 0 -7 ...
 $ accel_dumbbell_y        : int  -15 155 155 72 -30 166 150 159 25 -20 ...
 $ accel_dumbbell_z        : int  81 -205 -196 -148 -5 -186 -190 -191 9 7 ...
 $ magnet_dumbbell_x       : int  523 -502 -506 -576 -424 -543 -484 -515 -519 -531 ...
 $ magnet_dumbbell_y       : int  -528 388 349 238 252 262 354 350 348 321 ...
 $ magnet_dumbbell_z       : int  -56 -36 41 53 312 96 97 53 -32 -164 ...
 $ roll_forearm            : num  141 109 131 0 -176 150 155 -161 15.5 13.2 ...
 $ pitch_forearm           : num  49.3 -17.6 -32.6 0 -2.16 1.46 34.5 43.6 -63.5 19.4 ...
 $ yaw_forearm             : num  156 106 93 0 -47.9 89.7 152 -89.5 -139 -105 ...
 $ max_picth_forearm       : logi  NA NA NA NA NA NA ...
 $ min_pitch_forearm       : logi  NA NA NA NA NA NA ...
 $ amplitude_pitch_forearm : logi  NA NA NA NA NA NA ...
 $ total_accel_forearm     : int  33 39 34 43 24 43 32 47 36 24 ...
 $ var_accel_forearm       : logi  NA NA NA NA NA NA ...
 $ gyros_forearm_x         : num  0.74 1.12 0.18 1.38 -0.75 -0.88 -0.53 0.63 0.03 0.02 ...
 $ gyros_forearm_y         : num  -3.34 -2.78 -0.79 0.69 3.1 4.26 1.8 -0.74 0.02 0.13 ...
 $ gyros_forearm_z         : num  -0.59 -0.18 0.28 1.8 0.8 1.35 0.75 0.49 -0.02 -0.07 ...
 $ accel_forearm_x         : int  -110 212 154 -92 131 230 -192 -151 195 -212 ...
 $ accel_forearm_y         : int  267 297 271 406 -93 322 170 -331 204 98 ...
 $ accel_forearm_z         : int  -149 -118 -129 -39 172 -144 -175 -282 -217 -7 ...
 $ magnet_forearm_x        : int  -714 -237 -51 -233 375 -300 -678 -109 0 -403 ...
 $ magnet_forearm_y        : int  419 791 698 783 -787 800 284 -619 652 723 ...
 $ magnet_forearm_z        : int  617 873 783 521 91 884 585 -32 469 512 ...
  [list output truncated]
> NaCols <- sapply(train_data, function(x) mean(is.na(x))) > 0.95
> train_data <- train_data[,NaCols == FALSE]
> test_data <- test_data[,NaCols == FALSE]
> str(test_data)
'data.frame':   20 obs. of  59 variables:
 $ X                   : int  1 2 3 4 5 6 7 8 9 10 ...
 $ user_name           : chr  "pedro" "jeremy" "jeremy" "adelmo" ...
 $ raw_timestamp_part_1: int  1323095002 1322673067 1322673075 1322832789 1322489635 1322673149 1322673128 1322673076 1323084240 1322837822 ...
 $ raw_timestamp_part_2: int  868349 778725 342967 560311 814776 510661 766645 54671 916313 384285 ...
 $ cvtd_timestamp      : chr  "05/12/2011 14:23" "30/11/2011 17:11" "30/11/2011 17:11" "02/12/2011 13:33" ...
 $ num_window          : int  74 431 439 194 235 504 485 440 323 664 ...
 $ roll_belt           : num  123 1.02 0.87 125 1.35 -5.92 1.2 0.43 0.93 114 ...
 $ pitch_belt          : num  27 4.87 1.82 -41.6 3.33 1.59 4.44 4.15 6.72 22.4 ...
 $ yaw_belt            : num  -4.75 -88.9 -88.5 162 -88.6 -87.7 -87.3 -88.5 -93.7 -13.1 ...
 $ total_accel_belt    : int  20 4 5 17 3 4 4 4 4 18 ...
 $ gyros_belt_x        : num  -0.5 -0.06 0.05 0.11 0.03 0.1 -0.06 -0.18 0.1 0.14 ...
 $ gyros_belt_y        : num  -0.02 -0.02 0.02 0.11 0.02 0.05 0 -0.02 0 0.11 ...
 $ gyros_belt_z        : num  -0.46 -0.07 0.03 -0.16 0 -0.13 0 -0.03 -0.02 -0.16 ...
 $ accel_belt_x        : int  -38 -13 1 46 -8 -11 -14 -10 -15 -25 ...
 $ accel_belt_y        : int  69 11 -1 45 4 -16 2 -2 1 63 ...
 $ accel_belt_z        : int  -179 39 49 -156 27 38 35 42 32 -158 ...
 $ magnet_belt_x       : int  -13 43 29 169 33 31 50 39 -6 10 ...
 $ magnet_belt_y       : int  581 636 631 608 566 638 622 635 600 601 ...
 $ magnet_belt_z       : int  -382 -309 -312 -304 -418 -291 -315 -305 -302 -330 ...
 $ roll_arm            : num  40.7 0 0 -109 76.1 0 0 0 -137 -82.4 ...
 $ pitch_arm           : num  -27.8 0 0 55 2.76 0 0 0 11.2 -63.8 ...
 $ yaw_arm             : num  178 0 0 -142 102 0 0 0 -167 -75.3 ...
 $ total_accel_arm     : int  10 38 44 25 29 14 15 22 34 32 ...
 $ gyros_arm_x         : num  -1.65 -1.17 2.1 0.22 -1.96 0.02 2.36 -3.71 0.03 0.26 ...
 $ gyros_arm_y         : num  0.48 0.85 -1.36 -0.51 0.79 0.05 -1.01 1.85 -0.02 -0.5 ...
 $ gyros_arm_z         : num  -0.18 -0.43 1.13 0.92 -0.54 -0.07 0.89 -0.69 -0.02 0.79 ...
 $ accel_arm_x         : int  16 -290 -341 -238 -197 -26 99 -98 -287 -301 ...
 $ accel_arm_y         : int  38 215 245 -57 200 130 79 175 111 -42 ...
 $ accel_arm_z         : int  93 -90 -87 6 -30 -19 -67 -78 -122 -80 ...
 $ magnet_arm_x        : int  -326 -325 -264 -173 -170 396 702 535 -367 -420 ...
 $ magnet_arm_y        : int  385 447 474 257 275 176 15 215 335 294 ...
 $ magnet_arm_z        : int  481 434 413 633 617 516 217 385 520 493 ...
 $ roll_dumbbell       : num  -17.7 54.5 57.1 43.1 -101.4 ...
 $ pitch_dumbbell      : num  25 -53.7 -51.4 -30 -53.4 ...
 $ yaw_dumbbell        : num  126.2 -75.5 -75.2 -103.3 -14.2 ...
 $ total_accel_dumbbell: int  9 31 29 18 4 29 29 29 3 2 ...
 $ gyros_dumbbell_x    : num  0.64 0.34 0.39 0.1 0.29 -0.59 0.34 0.37 0.03 0.42 ...
 $ gyros_dumbbell_y    : num  0.06 0.05 0.14 -0.02 -0.47 0.8 0.16 0.14 -0.21 0.51 ...
 $ gyros_dumbbell_z    : num  -0.61 -0.71 -0.34 0.05 -0.46 1.1 -0.23 -0.39 -0.21 -0.03 ...
 $ accel_dumbbell_x    : int  21 -153 -141 -51 -18 -138 -145 -140 0 -7 ...
 $ accel_dumbbell_y    : int  -15 155 155 72 -30 166 150 159 25 -20 ...
 $ accel_dumbbell_z    : int  81 -205 -196 -148 -5 -186 -190 -191 9 7 ...
 $ magnet_dumbbell_x   : int  523 -502 -506 -576 -424 -543 -484 -515 -519 -531 ...
 $ magnet_dumbbell_y   : int  -528 388 349 238 252 262 354 350 348 321 ...
 $ magnet_dumbbell_z   : int  -56 -36 41 53 312 96 97 53 -32 -164 ...
 $ roll_forearm        : num  141 109 131 0 -176 150 155 -161 15.5 13.2 ...
 $ pitch_forearm       : num  49.3 -17.6 -32.6 0 -2.16 1.46 34.5 43.6 -63.5 19.4 ...
 $ yaw_forearm         : num  156 106 93 0 -47.9 89.7 152 -89.5 -139 -105 ...
 $ total_accel_forearm : int  33 39 34 43 24 43 32 47 36 24 ...
 $ gyros_forearm_x     : num  0.74 1.12 0.18 1.38 -0.75 -0.88 -0.53 0.63 0.03 0.02 ...
 $ gyros_forearm_y     : num  -3.34 -2.78 -0.79 0.69 3.1 4.26 1.8 -0.74 0.02 0.13 ...
 $ gyros_forearm_z     : num  -0.59 -0.18 0.28 1.8 0.8 1.35 0.75 0.49 -0.02 -0.07 ...
 $ accel_forearm_x     : int  -110 212 154 -92 131 230 -192 -151 195 -212 ...
 $ accel_forearm_y     : int  267 297 271 406 -93 322 170 -331 204 98 ...
 $ accel_forearm_z     : int  -149 -118 -129 -39 172 -144 -175 -282 -217 -7 ...
 $ magnet_forearm_x    : int  -714 -237 -51 -233 375 -300 -678 -109 0 -403 ...
 $ magnet_forearm_y    : int  419 791 698 783 -787 800 284 -619 652 723 ...
 $ magnet_forearm_z    : int  617 873 783 521 91 884 585 -32 469 512 ...
 $ problem_id          : int  1 2 3 4 5 6 7 8 9 10 ...
> train_data <- train_data[,7:59]
> test_data <- test_data[,7:59]
> str(test_data)
'data.frame':   20 obs. of  53 variables:
 $ roll_belt           : num  123 1.02 0.87 125 1.35 -5.92 1.2 0.43 0.93 114 ...
 $ pitch_belt          : num  27 4.87 1.82 -41.6 3.33 1.59 4.44 4.15 6.72 22.4 ...
 $ yaw_belt            : num  -4.75 -88.9 -88.5 162 -88.6 -87.7 -87.3 -88.5 -93.7 -13.1 ...
 $ total_accel_belt    : int  20 4 5 17 3 4 4 4 4 18 ...
 $ gyros_belt_x        : num  -0.5 -0.06 0.05 0.11 0.03 0.1 -0.06 -0.18 0.1 0.14 ...
 $ gyros_belt_y        : num  -0.02 -0.02 0.02 0.11 0.02 0.05 0 -0.02 0 0.11 ...
 $ gyros_belt_z        : num  -0.46 -0.07 0.03 -0.16 0 -0.13 0 -0.03 -0.02 -0.16 ...
 $ accel_belt_x        : int  -38 -13 1 46 -8 -11 -14 -10 -15 -25 ...
 $ accel_belt_y        : int  69 11 -1 45 4 -16 2 -2 1 63 ...
 $ accel_belt_z        : int  -179 39 49 -156 27 38 35 42 32 -158 ...
 $ magnet_belt_x       : int  -13 43 29 169 33 31 50 39 -6 10 ...
 $ magnet_belt_y       : int  581 636 631 608 566 638 622 635 600 601 ...
 $ magnet_belt_z       : int  -382 -309 -312 -304 -418 -291 -315 -305 -302 -330 ...
 $ roll_arm            : num  40.7 0 0 -109 76.1 0 0 0 -137 -82.4 ...
 $ pitch_arm           : num  -27.8 0 0 55 2.76 0 0 0 11.2 -63.8 ...
 $ yaw_arm             : num  178 0 0 -142 102 0 0 0 -167 -75.3 ...
 $ total_accel_arm     : int  10 38 44 25 29 14 15 22 34 32 ...
 $ gyros_arm_x         : num  -1.65 -1.17 2.1 0.22 -1.96 0.02 2.36 -3.71 0.03 0.26 ...
 $ gyros_arm_y         : num  0.48 0.85 -1.36 -0.51 0.79 0.05 -1.01 1.85 -0.02 -0.5 ...
 $ gyros_arm_z         : num  -0.18 -0.43 1.13 0.92 -0.54 -0.07 0.89 -0.69 -0.02 0.79 ...
 $ accel_arm_x         : int  16 -290 -341 -238 -197 -26 99 -98 -287 -301 ...
 $ accel_arm_y         : int  38 215 245 -57 200 130 79 175 111 -42 ...
 $ accel_arm_z         : int  93 -90 -87 6 -30 -19 -67 -78 -122 -80 ...
 $ magnet_arm_x        : int  -326 -325 -264 -173 -170 396 702 535 -367 -420 ...
 $ magnet_arm_y        : int  385 447 474 257 275 176 15 215 335 294 ...
 $ magnet_arm_z        : int  481 434 413 633 617 516 217 385 520 493 ...
 $ roll_dumbbell       : num  -17.7 54.5 57.1 43.1 -101.4 ...
 $ pitch_dumbbell      : num  25 -53.7 -51.4 -30 -53.4 ...
 $ yaw_dumbbell        : num  126.2 -75.5 -75.2 -103.3 -14.2 ...
 $ total_accel_dumbbell: int  9 31 29 18 4 29 29 29 3 2 ...
 $ gyros_dumbbell_x    : num  0.64 0.34 0.39 0.1 0.29 -0.59 0.34 0.37 0.03 0.42 ...
 $ gyros_dumbbell_y    : num  0.06 0.05 0.14 -0.02 -0.47 0.8 0.16 0.14 -0.21 0.51 ...
 $ gyros_dumbbell_z    : num  -0.61 -0.71 -0.34 0.05 -0.46 1.1 -0.23 -0.39 -0.21 -0.03 ...
 $ accel_dumbbell_x    : int  21 -153 -141 -51 -18 -138 -145 -140 0 -7 ...
 $ accel_dumbbell_y    : int  -15 155 155 72 -30 166 150 159 25 -20 ...
 $ accel_dumbbell_z    : int  81 -205 -196 -148 -5 -186 -190 -191 9 7 ...
 $ magnet_dumbbell_x   : int  523 -502 -506 -576 -424 -543 -484 -515 -519 -531 ...
 $ magnet_dumbbell_y   : int  -528 388 349 238 252 262 354 350 348 321 ...
 $ magnet_dumbbell_z   : int  -56 -36 41 53 312 96 97 53 -32 -164 ...
 $ roll_forearm        : num  141 109 131 0 -176 150 155 -161 15.5 13.2 ...
 $ pitch_forearm       : num  49.3 -17.6 -32.6 0 -2.16 1.46 34.5 43.6 -63.5 19.4 ...
 $ yaw_forearm         : num  156 106 93 0 -47.9 89.7 152 -89.5 -139 -105 ...
 $ total_accel_forearm : int  33 39 34 43 24 43 32 47 36 24 ...
 $ gyros_forearm_x     : num  0.74 1.12 0.18 1.38 -0.75 -0.88 -0.53 0.63 0.03 0.02 ...
 $ gyros_forearm_y     : num  -3.34 -2.78 -0.79 0.69 3.1 4.26 1.8 -0.74 0.02 0.13 ...
 $ gyros_forearm_z     : num  -0.59 -0.18 0.28 1.8 0.8 1.35 0.75 0.49 -0.02 -0.07 ...
 $ accel_forearm_x     : int  -110 212 154 -92 131 230 -192 -151 195 -212 ...
 $ accel_forearm_y     : int  267 297 271 406 -93 322 170 -331 204 98 ...
 $ accel_forearm_z     : int  -149 -118 -129 -39 172 -144 -175 -282 -217 -7 ...
 $ magnet_forearm_x    : int  -714 -237 -51 -233 375 -300 -678 -109 0 -403 ...
 $ magnet_forearm_y    : int  419 791 698 783 -787 800 284 -619 652 723 ...
 $ magnet_forearm_z    : int  617 873 783 521 91 884 585 -32 469 512 ...
 $ problem_id          : int  1 2 3 4 5 6 7 8 9 10 ...
> inTrain<- createDataPartition(train_data$classe, p=0.6, list=FALSE)
> training<- train_data[inTrain,]
> validating<- train_data[-inTrain,]
> dim(training)
[1] 11776    53
> dim(validating)
[1] 7846   53
> DT_modelfit<- train(classe ~. , data=training, method= "rpart")
> fancyRpartPlot(DT_modelfit$finalModel)
> DT_prediction <- predict(DT_modelfit, validating)
> confusionMatrix(as.factor(DT_prediction), as.factor(validating$classe))
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 2026  617  656  559  212
         B   35  535   42  233  210
         C  163  366  670  494  396
         D    0    0    0    0    0
         E    8    0    0    0  624

Overall Statistics
                                          
               Accuracy : 0.4913          
                 95% CI : (0.4802, 0.5025)
    No Information Rate : 0.2845          
    P-Value [Acc > NIR] : < 2.2e-16       
                                          
                  Kappa : 0.3352          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.9077  0.35244  0.48977   0.0000  0.43273
Specificity            0.6359  0.91783  0.78095   1.0000  0.99875
Pos Pred Value         0.4978  0.50711  0.32073      NaN  0.98734
Neg Pred Value         0.9454  0.85525  0.87876   0.8361  0.88661
Prevalence             0.2845  0.19347  0.17436   0.1639  0.18379
Detection Rate         0.2582  0.06819  0.08539   0.0000  0.07953
Detection Prevalence   0.5187  0.13446  0.26625   0.0000  0.08055
Balanced Accuracy      0.7718  0.63513  0.63536   0.5000  0.71574
> RF_modelfit <- train(classe ~ ., data = training, method = "rf", ntree = 100)

> RF_modelfit <- train(classe ~ ., data = training, method = "rf", ntree = 100)

> 
> 


> > > 
> RF_modelfit <- train(classe ~ ., data = training, method = "rf", ntree = 100)
> RF_prediction<- predict(RF_modelfit, validating)
> qplot(RF_prediction,validating$classe, colour=validating$classe)
Warning message:
`qplot()` was deprecated in ggplot2 3.4.0.
This warning is displayed once every 8 hours.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
generated. 
Error in grid.Call.graphics(C_upviewport, as.integer(n)) : 
  cannot pop the top-level viewport ('grid' and 'graphics' output mixed?)
> > RF_confusionMatrix<-confusionMatrix(as.factor(RF_prediction), as.factor(validating$classe))
> RF_confusionMatrix
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 2229    6    0    0    0
         B    1 1509   12    0    1
         C    0    3 1351   21    3
         D    0    0    5 1264    4
         E    2    0    0    1 1434

Overall Statistics
                                          
               Accuracy : 0.9925          
                 95% CI : (0.9903, 0.9943)
    No Information Rate : 0.2845          
    P-Value [Acc > NIR] : < 2.2e-16       
                                          
                  Kappa : 0.9905          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.9987   0.9941   0.9876   0.9829   0.9945
Specificity            0.9989   0.9978   0.9958   0.9986   0.9995
Pos Pred Value         0.9973   0.9908   0.9804   0.9929   0.9979
Neg Pred Value         0.9995   0.9986   0.9974   0.9967   0.9988
Prevalence             0.2845   0.1935   0.1744   0.1639   0.1838
Detection Rate         0.2841   0.1923   0.1722   0.1611   0.1828
Detection Prevalence   0.2849   0.1941   0.1756   0.1622   0.1832
Balanced Accuracy      0.9988   0.9959   0.9917   0.9908   0.9970
> gbm_modelfit<- train(classe~., data=training, method="gbm", verbose= FALSE)

> gbm_prediction<- predict(gbm_modelfit, validating)
Error: object 'gbm_modelfit' not found
> qplot(gbm_prediction,validating$classe, colour=validating$classe)
Error in `geom_point()`:
! Problem while computing aesthetics.
ℹ Error occurred in the 1st layer.
Caused by error:
! object 'gbm_prediction' not found
Run `rlang::last_trace()` to see where the error occurred.
> 
> 
> 
> gbm_modelfit<- train(classe~., data=training, method="gbm", verbose= FALSE)

> gbm_prediction<- predict(gbm_modelfit, validating)
Error: object 'gbm_modelfit' not found
> qplot(gbm_prediction,validating$classe, colour=validating$classe)
Error in `geom_point()`:
! Problem while computing aesthetics.
ℹ Error occurred in the 1st layer.
Caused by error:
! object 'gbm_prediction' not found
Run `rlang::last_trace()` to see where the error occurred.
> 
> gbm_modelfit<- train(classe~., data=training, method="gbm", verbose= FALSE)

> gbm_confusionMatrix<-confusionMatrix(as.factor(gbm_prediction), as.factor(validating$classe))
Error: object 'gbm_prediction' not found
> gbm_modelfit<- train(classe~., data=training, method="gbm", verbose= FALSE)

> 
> gbm_modelfit<- train(classe~., data=training, method="gbm", verbose= FALSE)

> gbm_modelfit<- train(classe~., data=training, method="gbm", verbose= FALSE)

> gbm_prediction<- predict(gbm_modelfit, validating)
Error: object 'gbm_modelfit' not found
> gbm_modelfit<- train(classe~., data=training, method="gbm", verbose= FALSE)

> gbm_confusionMatrix<-confusionMatrix(as.factor(gbm_prediction), as.factor(validating$classe))
Error: object 'gbm_prediction' not found
> gbm_confusionMatrix
Error: object 'gbm_confusionMatrix' not found
> q()
> test_prediction<- predict(RF_modelfit, test_data)
> test_prediction
 [1] B A B A A E D B A A B C B A E E A B B B
Levels: A B C D E
> 
